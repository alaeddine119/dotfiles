# ~/.blerc

# =========================================================================== #
#  1. UI CLEANUP (Silence Everything)                                         #
# =========================================================================== #
bleopt prompt_status_line=
bleopt prompt_eol_mark=''
bleopt exec_errexit_mark=
bleopt exec_elapsed_mark=
bleopt exec_exit_mark=
bleopt edit_marker=
bleopt edit_marker_error=

# --- COMPLETION CONFIGURATION ---
function my/set-up-completion {
    bleopt complete_auto_delay=300
    bleopt complete_auto_complete_opts=syntax-unique:suppress-inside-line
}
ble-import core-complete -C 'my/set-up-completion'

# =========================================================================== #
#  2. KEY BINDINGS & INPUT TUNING (Conflict-Free)                             #
# =========================================================================== #
ble-import -d integration/fzf-completion
ble-import -d integration/fzf-key-bindings

# --- HISTORY NAVIGATION ---
ble-bind -f up history-search-backward
ble-bind -f down history-search-forward
ble-bind -f M-p history-search-backward
ble-bind -f M-n history-search-forward

# --- INPUT RESILIENCE ---
# 1 Million characters to handle large pastes without truncation
bleopt decode_macro_limit=1000000
bleopt term_bracketed_paste_mode=on

# Give VS Code more time to respond, but don't poll too aggressively
bleopt complete_timeout_auto=5000
# Removed 'complete_polling_cycle=10' to prevent CPU choking during fast input

# --- EXECUTION & ESCAPE ---
ble-bind -f 'M-RET' 'accept-line'
ble-bind -f 'C-m' accept-line
ble-bind -f 'RET' accept-line
bleopt decode_isolated_esc=esc

# --- UTILS ---
ble-bind -c 'M-r' 'source ~/.blerc'

# =========================================================================== #
#  3. ROSE PINE MOON THEME                                                    #
# =========================================================================== #
ble-face -s syntax_default fg=#e0def4
ble-face -s syntax_command fg=#c4a7e7
ble-face -s command_function fg=#c4a7e7
ble-face -s command_builtin fg=#c4a7e7
ble-face -s command_alias fg=#c4a7e7
ble-face -s command_keyword fg=#9ccfd8
ble-face -s syntax_delimiter fg=#e0def4
ble-face -s syntax_quoted fg=#f6c177
ble-face -s syntax_quotation fg=#f6c177
ble-face -s syntax_varname fg=#ea9a97
ble-face -s syntax_param_expansion fg=#ea9a97
ble-face -s argument_option fg=#ea9a97
ble-face -s syntax_error fg=#eb6f92
ble-face -s syntax_escape fg=#3e8fb0
ble-face -s syntax_expr fg=#3e8fb0
ble-face -s syntax_comment fg=#908caa
ble-face -s auto_complete fg=#908caa
ble-face -s region_match bg=#3e8fb0,fg=#232136
ble-face -s region bg=#2a273f,fg=#e0def4
ble-face -s region_target bg=#2a273f,fg=#e0def4
ble-face -s menu_complete_match fg=#9ccfd8,bold
ble-face -s menu_complete_selected bg=#393552,fg=#e0def4
ble-face -s menu_desc_default fg=#908caa

# =========================================================================== #
#  4. PASTE & PERFORMANCE TUNING (COMPATIBLE MODE)                            #
# =========================================================================== #

# 1. Increase input limit (The Buffer)
# Ensures ble.sh accepts the full block of text from Copilot.
bleopt decode_macro_limit=1000000

# 2. Increase Line Length Limit (The Editor)
# FIX: Increased to 1,000,000 so the script isn't cut off before the 'PY' heredoc close.
bleopt line_limit_length=1000000
bleopt line_limit_type=none

# 3. Aggressive Syntax Highlighting Timeout
# Since we are allowing huge lines, we MUST kill highlighting quickly
# if it starts lagging, otherwise the terminal will freeze.
bleopt highlight_timeout_sync=500
